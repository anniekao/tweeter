<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Meta Information -->
    <title>Tweeter - Home Page</title>

    <!-- External CSS -->
    <link rel="stylesheet" href="/vendor/normalize-4.1.1.css" type="text/css" />

    <!-- App CSS -->
    <link rel="stylesheet" href="/styles/layout.css" type="text/css" />
    <link rel="stylesheet" href="/styles/nav.css" type="text/css" />
    <link rel="stylesheet" href="/styles/header.css" type="text/css" />
    <link rel="stylesheet" href="/styles/new-tweet.css" type="text/css" />
    <link rel="stylesheet" href="/styles/tweets.css" type="text/css" />

    <!-- Google fonts -->
    <link href="https://fonts.googleapis.com/css?family=Bungee|Source+Sans+Pro&display=swap" rel="stylesheet">

    <!-- External JS -->
    <script type="text/javascript" src="/vendor/jquery-2.2.3.min.js"></script>

    <!-- App JS -->
    <script type="text/javascript" src="/scripts/app.js"></script>
    <script type="text/javascript" src="/scripts/composer-char-counter.js"></script>

    <!-- Jquery-validation plugin -->
    <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.11.1/jquery.validate.min.js"></script>

    <script> 
       $(function() {
        const $form = $('#tweet-form');

        // Form validation using jquery-validation plugin
        $form.validate({
          rules: {
            text: {
            required: true,
            minlength: 2,
            maxlength: 140
            }
          },
          messages: {
            text: {
              required: `<div class="err">Please enter a tweet </div>`,
              minlength: `<div class="err">Your tweet is too short!</div>`,
              maxlength: `<div class="err">Your tweet is too long!</div>`
            }
          },
          submitHandler: function(form) {
            $.ajax({
              url: '/tweets',
              type: 'POST',
              data: $form.serialize(),
              success: function() {
                loadTweets();
              },
              error: function() {
                alert('Tweet is too short!');
              }
            });
            $('textarea').val('');
            return false;
          }
        });
               

        // $form.submit(function (event) {
        //   event.preventDefault();
        
        //   // AJAX call to post tweets
          
          
        // });
       })
    </script>
  </head>

  <body>

    <!-- Top nav bar (fixed) -->
    <nav>
      <span>tweeter</span>
      <div class="write-tweet">
        <span class="text"><span class="bold">Write </span>a new tweet</span>
        <span id="double-chevron">‚è¨</span>
      </div>
    </nav>

    <header>
      <div>
        <img src="./images/profile-hex.png">
      </div>

      <div>
        <h2>Your Name</h2>
      </div>
    </header>

    <!-- Page-specific (main) content here -->
    <main class="container">
      <section id="new-tweet">
        <h2>Compose Tweet</h2>
        <form id="tweet-form" method="POST" action="/tweets">
          <textarea name="text" placeholder="What are you humming about?"></textarea>
          <br>
          <input type="submit" value="Tweet" id="submit-tweet">
          <!-- To-do: Add reset button to clear textarea -->
          <span class="counter">140</span>
        </form>
      </section>

      <section id="tweets-container"></section>
    </main>

    <footer></footer>
  </body>
</html>
